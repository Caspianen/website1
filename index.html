<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Heart Particle Animation</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <canvas id="canvas"></canvas>
  <script>
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let particles = [];
    let attract = false;
    let mouse = { x: canvas.width/2, y: canvas.height/2 };

    // formula heart shape
    function heartFunction(t) {
      const x = 16 * Math.pow(Math.sin(t), 3);
      const y = -(13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t));
      return {x, y};
    }

    // buat partikel
    for (let i = 0; i < 1000; i++) {
      const t = Math.random() * Math.PI * 2;
      const point = heartFunction(t);
      particles.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        targetX: canvas.width/2 + point.x * 15,
        targetY: canvas.height/2 + point.y * 15,
        size: Math.random() * 2 + 1,
        opacity: Math.random(),
        glowSpeed: Math.random() * 0.02 + 0.01,
        color: "rgba(255,105,180,1)" // pink
      });
    }

    function animate() {
      ctx.fillStyle = "rgba(0,0,0,0.2)";
      ctx.fillRect(0,0,canvas.width,canvas.height);

      for (let p of particles) {
        let tx, ty;

        if (attract) {
          // saat klik & tahan → partikel mengikuti kursor
          tx = mouse.x + (Math.random() - 0.5) * 50; 
          ty = mouse.y + (Math.random() - 0.5) * 50; 
        } else {
          // saat dilepas → balik ke love dengan efek berdenyut
          tx = p.targetX + Math.sin(Date.now() * 0.002 + p.x) * 2;
          ty = p.targetY + Math.cos(Date.now() * 0.002 + p.y) * 2;
        }

        // interpolasi pergerakan
        p.x += (tx - p.x) * 0.05;
        p.y += (ty - p.y) * 0.05;

        // glowing
        p.opacity += p.glowSpeed;
        if (p.opacity > 1 || p.opacity < 0) p.glowSpeed *= -1;

        ctx.beginPath();
        ctx.arc(p.x, p.y, p.size, 0, Math.PI*2);
        ctx.fillStyle = `rgba(255,105,180,${p.opacity})`;
        ctx.fill();
      }

      requestAnimationFrame(animate);
    }

    animate();

    // event kontrol mouse
    canvas.addEventListener("mousedown", e => {
      attract = true;
      mouse.x = e.clientX;
      mouse.y = e.clientY;
    });

    canvas.addEventListener("mouseup", () => {
      attract = false;
    });

    canvas.addEventListener("mousemove", e => {
      if (attract) {
        mouse.x = e.clientX;
        mouse.y = e.clientY;
      }
    });

    window.addEventListener("resize", () => {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    });
  </script>
</body>
</html>
